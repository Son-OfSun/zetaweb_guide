# Система кроссирования

## Описание системы кроссирования

Система кроссирования предназначена для поиска товарных позиций не только по собственному артикулу, но и с помощью других номеров, как того же, так и иных производителей. 

Таким образом, _кроссирование - это формирование кросс-записи для позиции, предназначенной для поиска товара с помощью другого номера и бренда._

{% hint style="info" %}
**Кросс-запись** - запись, которая состоит из артикула и бренда \(позиции, которую мы ищем\), кросс-артикула и кросс-бренда \(позиции, через которую мы ищем\) и типа кросс-записи, позволяющего определить, что означает этот кросс-номер.
{% endhint %}

При работе с кросс-записями часто используется сленг, по сложившейся традиции определяющий порядок расположения артикулов, брендов, кросс-артикулов и кросс-брендов в кросс-записи:   
  
"Слева" - товар, который мы хотим найти \(т.е. его артикул и бренд\).   
"Справа" - кросс-номер и кросс-бренд \(т.е. значения, через которые мы ищем товар\).

_Таким образом, кросс-запись выглядит следующим образом:  
Артикул - Бренд \(левая часть\) / Кросс-артикул - Кросс-бренд \(правая часть\)._

Посмотрим на карточку кросс-записи:

![](../../.gitbook/assets/image%20%2866%29.png)

{% hint style="info" %}
**Важно!** Тип кросса относится и определяет исключительно пару кросс-номер и кросс-бренд.   
Т.е., когда установлен, например, тип кросса "Оригинальный номер", то это значит, что кросс-артикул и кросс-бренд - это производитель автомобилей и его оригинальный номер зачасти.
{% endhint %}

Для формирования кросс-записей пользователь может устанавливать их непосредственно из карточки номенклатуры с закладки "Кроссы", 

![&#x41A;&#x430;&#x440;&#x442;&#x43E;&#x447;&#x43A;&#x430; &#x43D;&#x43E;&#x43C;&#x435;&#x43D;&#x43A;&#x43B;&#x430;&#x442;&#x443;&#x440;&#x44B; &#x441; &#x43A;&#x440;&#x43E;&#x441;&#x441;&#x43E;&#x43C; &quot;&#x441;&#x430;&#x43C; &#x43D;&#x430; &#x441;&#x435;&#x431;&#x44F;&quot;](../../.gitbook/assets/image%20%28447%29.png)

либо вносить / загружать их в регистр "Кроссы". 

![&#x412;&#x438;&#x434; &#x440;&#x435;&#x433;&#x438;&#x441;&#x442;&#x440;&#x430; &quot;&#x41A;&#x440;&#x43E;&#x441;&#x441;&#x44B;&quot;](../../.gitbook/assets/image%20%28218%29.png)

При создании номенклатуры всегда создается запись "сам на себя" с типом 1 \(при наличии бренда и артикула\).

В форме кросс-записи по умолчанию работают правила подстановки:

* если бренд и артикул "слева" равны бренду и артикулу "справа" тогда тип кросса = 1.
* если бренд справа производитель авто = истина тогда тип кросса = 8.
* если бренд справа производитель авто = ложь тогда тип кросса = 2.

  Пользователь может выбрать вручную другой тип кросса.

Записи будут связаны по паре артикул + бренд и отражены в карточке номенклатуры автоматически.

В кросс-записи также хранится пользователь, последний редактировавший запись, а также дата и время редактирования.

![](../../.gitbook/assets/image%20%2866%29.png)

Вы можете добавить комментарий для любой записи, но значимым изменением, влияющим на ответственного или дату изменения являются артикул, бренд, кросс-артикул, кросс-бренд и тип кросса.

{% hint style="info" %}
**Пример:**  
Компания VAG производит позицию **"**Пробка сливная масляного поддона двигателя с прокладкой" с артикулом "N 908 132 02".

Компания TOPRAN производит аналог этой позиции с артикулом "109035785".

Чтобы позицию компании TOPRAN можно было найти, то в качестве кросс-номера к своему изделию она указывает артикул компании VAG - "N 908 132 02".

**Кросс-запись:**  
Артикул:  109035785  
Бренд: TOPRAN   
Кросс-артикул: N 908 132 02  
Кросс-бренд: VAG  
Тип кросса: Оригинальный номер
{% endhint %}

Для поиска в подавляющем большинстве распространенных систем используется поиск по кросс-номеру. 

{% hint style="info" %}
**Важно!** Для поиска используется поле "Кросс-артикул" в очищенном виде \(т.е. без пробелов и спецсимволов\).
{% endhint %}

Таким образом, получается, что оригинальная запчасть для поиска "самой себя" имеет в качестве кросс-номера собственный номер и бренд, а все аналоги - номер и бренд оригинальной запчасти.

{% hint style="info" %}
Кроме типа кросс-номера "сам на себя", кросс-номера к аналогу, существуют и другие типы кросс-номеров - например, короткий номер производителя и т.п.   
Подробней предопределенные типы кроссов описаны [ниже](https://help-zetaweb.zetasoft.ru/~/edit/drafts/-LU1CuYFVNWIVJf-esOD/opisanie-i-nastroika/upravlenie-nomenklaturoi/perekrossirovka-nomenklatury#opisanie-tipov-krossov), а пользователь имеет возможность создавать собственные типы кроссов.
{% endhint %}



## Режимы кроссирования в системе Zeta Web

В первую очередь, необходимо выбрать - какой вариант кроссирования наиболее Вам подходит.

В продукте доступны 3 варианта:

* Прямое кроссирование
* Прямое и обратное кроссирование
* Полное кроссирование

Выбор варианта устанавливается в основных настройках системы через меню "Zeta Web - Настройка и администрирование - Настройки Zeta Web", вкладка "Подбор товаров".

![&#x412;&#x430;&#x440;&#x438;&#x430;&#x43D;&#x442;&#x44B; &#x43A;&#x440;&#x43E;&#x441;&#x441;&#x438;&#x440;&#x43E;&#x432;&#x430;&#x43D;&#x438;&#x44F;](../../.gitbook/assets/image%20%28528%29.png)

## Режим "Прямое кроссирование"

При **прямом** кроссировании пользователь создает запись в кросс-листе \(из номенклатуры или напрямую в регистре кроссов\) для пары артикул + бренд. Более никаких действий не происходит.

{% hint style="info" %}
**Пример:**   
Артикул:  109035785  
Бренд: TOPRAN   
Кросс-артикул: N 908 132 02  
Кросс-бренд: VAG  
Тип кросса: Оригинальный номер
{% endhint %}

Надо понимать, что при таком формировании записей по номеру оригинальной запчасти VAG смогут найти её аналог - запчасть с брендом TOPRUN.   
Однако, если кто-то начнет искать запчасть по артикулу детали TOPRUN - номеру 109035785, то найдут только запчасть с брендом TOPRUN

Чтобы запчасть VAG стала её аналогом, необходимо создать ещё одну кросс-запись:  
Артикул: N 908 132 02  
Бренд: VAG  
Кросс-артикул: 109035785  
Кросс-бренд: TOPRUN  
Тип кросса: Аналог \(сравнительный номер\)

Это может использоваться, когда компания сама определяет верность каждого кросса и запчасти не являются взаимозаменяемыми.

Чаще встречается другая ситуация, когда считается, что запчасти полностью могут заменить друг друга, и для упрощения этого процесса используется режим "Прямое и обратное кроссирование".

## Режим "Прямое и обратное кроссирование"

В этом случае при создании "прямой" кросс-записи автоматически формируется "обратная" кросс-запись.

Формирование обратной записи \(разворот\) происходит по правилам, описанным для каждого типа кроссов.  
Эти правила поставляются в рамках начальных данных системы Zeta Web и зафиксированы в регистре "Правила конвертации типов кроссов".  
Для тех типов кроссов, которые не предусматривают формирование обратной записи \(она будет ошибочной\), предусмотрен специальный флаг "Не разворачивается".

{% hint style="info" %}
**Важно!** Для правильного определения типа кросса необходима информация, является ли бренд производителем автомобилей.   
Необходимо установить флаг "Это производитель автомобилей" во всех брендах, производящих авто - т.е. выпускающих оригинальные запчасти.
{% endhint %}

Рассмотрим формирование "прямой" и "обратной" записи.

{% hint style="info" %}
**Установим "прямую" кросс-запись:**

Артикул:  109035785  
Бренд: TOPRAN   
Кросс-артикул: N 908 132 02  
Кросс-бренд: VAG  
Тип кросса: Оригинальный номер

**Автоматически будет создана "обратная" кросс-запись:**

Артикул:  N 908 132 02  
Бренд: VAG   
Кросс-артикул: 109035785  
Кросс-бренд: TOPRUN  
Тип кросса: Аналог \(сравнительный номер\)
{% endhint %}

Т.к. бренд TOPRUN не является производителем автомобилей, то с помощью правил мы установили тип кросса: Аналог \(сравнительный номер\).

В случае, когда пользователь системы считает, что все запчасти, скроссированные друг на друга являются заменителями, то можно использовать вариант полного кроссирования.

## Режим "Полное кроссирование"

В этом режиме будут автоматически созданы кроссы для всех пар артикул + бренд, имеющих кросс-номера друг к другу.

При этом для тех пар, что получаются в результате сопоставления кросс-листов, тип кросса определяется автоматически \(см. алгоритм определения типа кросса для полного кроссирования\).

## Типов кроссов и правила конвертации

Система поддерживает неограниченное количество типов кроссов, в том числе ряд предопределенных, используемых, в том числе, для автоматического кроссирования.   
  
Типов кроссов хранятся в справочнике "Типы кроссов", расположенном в меню "Zeta Web - Каталог и товары - Кроссы номенклатуры - Типы кроссов".

![&#x422;&#x438;&#x43F;&#x44B; &#x43A;&#x440;&#x43E;&#x441;&#x441;&#x43E;&#x432; &#x43D;&#x43E;&#x43C;&#x435;&#x43D;&#x43A;&#x43B;&#x430;&#x442;&#x443;&#x440;&#x44B;](../../.gitbook/assets/image%20%28112%29.png)

Правила конвертации устанавливаются в регистре "Правила конвертации типов кроссов" и используют флаг "Это производитель автомобилей" из бренда для определения разворота \(обратного кросса\).

![&#x41F;&#x440;&#x430;&#x432;&#x438;&#x43B;&#x430; &#x440;&#x430;&#x437;&#x432;&#x43E;&#x440;&#x43E;&#x442;&#x430; &#x442;&#x438;&#x43F;&#x43E;&#x432; &#x43A;&#x440;&#x43E;&#x441;&#x441;&#x43E;&#x432;](../../.gitbook/assets/image%20%28340%29.png)

## **Предопределенные типы кроссов**

### Кросс "сам на себя". Тип 1.

* одинаков в обе стороны;
* создается автоматически.

{% hint style="info" %}
Пример **кросс-записи**:  
Бренд: Bosch   
Артикул: 3397907   
Кросс-бренд: Bosch   
Кросс-артикул: 3397907   
Тип кросса: Сам на себя
{% endhint %}

### Аналог \(сравнительный номер\). Тип 2.

* разворачивается по правилам;
* устанавливается для кросс-номеров брендов, не являющихся производителями автомобилей.

{% hint style="info" %}
Пример **кросс-записи:**   
Бренд: Valeo   
Артикул: 567940   
Кросс-бренд: Bosch   
Кросс-артикул: 3397907   
Тип кросса: Аналог \(сравнительный номер\)
{% endhint %}

### Короткий номер. Тип 3.

* не разворачивается;
* устанавливается в том случае, если бренд слева и бренд справа равны, и мы устанавливаем дополнительный короткий номер того же производителя.

{% hint style="info" %}
Пример **кросс-записи:**  
Бренд: Bosch   
Артикул: 3397907   
Кросс-бренд: Bosch   
Кросс-артикул: AR 601S   
Тип кросса: Короткий номер
{% endhint %}

### Оригинальный номер. Тип 8.

* разворачивается по правилам;
* устанавливается для кросс-номеров брендов, являющихся производителями автомобилей.

{% hint style="info" %}
Пример **кросс-записи:**  
Артикул:  109035785  
Бренд: TOPRAN   
Кросс-артикул: N 908 132 02  
Кросс-бренд: VAG  
Тип кросса: Оригинальный номер
{% endhint %}

### Устаревший номер. Тип 9.

* разворачивается по правилам;
* устанавливается в том случае, если бренд слева и бренд справа равны, а производитель выпустил новую деталь вместо предыдущей.

{% hint style="info" %}
Пример **кросс-записи:**  
Артикул:  N 908 132 03  
Бренд: VAG   
Кросс-артикул: N 908 132 02  
Кросс-бренд: VAG  
Тип кросса: Устаревший номер
{% endhint %}

### Номер изготовителя. Тип 11.

* разворачивается по правилам;
* устанавливается в том случае, если бренд слева - это производитель авто, а кросс-номер и кросс-бренд - это производитель оригинальной запчасти, которая продается под брендом производителя авто.

{% hint style="info" %}
Пример **кросс-записи:**  
Артикул:  1K1819653B  
Бренд: VAG   
Кросс-артикул: 2939  
Кросс-бренд: MANN-FILTER  
Тип кросса: Номер изготовителя
{% endhint %}

### Штрих-код. Тип 14.

* не разворачивается;
* устанавливается в том случае, если бренд слева и бренд справа равны, и мы устанавливаем штрих-код того же производителя.

{% hint style="info" %}
Пример **кросс-записи:**  
Артикул:  3397907  
Бренд: Bosch  
Кросс-артикул: 1111111111 \(штрих код для примера\)  
Кросс-бренд: Bosch  
Тип кросса: Штрих-код
{% endhint %}

### Составная часть. Тип 20.

* не разворачивается;
* устанавливается в том случае, если кросс-артикул - это составная часть запчасти, чего-либо большего. Бренд и кросс-бренд могут отличаться.

{% hint style="info" %}
Пример **кросс-записи:**  
Артикул:  1K0505311AB  
Бренд: VAG   
Кросс-артикул: 2991701  
Кросс-бренд: LEMFORDER  
Тип кросса: Составная часть
{% endhint %}

### Короткий номер другого производителя. Тип 103.

* не разворачивается;
* устанавливается в том случае, если бренд слева и бренд справа не равны, и мы устанавливаем дополнительный короткий номер другого производителя.

{% hint style="info" %}
Пример **кросс-записи:**  
Бренд: Valeo   
Артикул: 567940  
Кросс-бренд: Bosch   
Кросс-артикул: AR 601S   
Тип кросса: Короткий номер другого производителя
{% endhint %}

### Штрих-код другой номенклатуры. Тип 114.

* не разворачивается;
* устанавливается в том случае, если бренд слева и бренд справа не равны, а мы имеем штрих-код от другого производителя.

{% hint style="info" %}
Пример **кросс-записи:**  
Артикул:  567940  
Бренд: Valeo  
Кросс-артикул: 1111111111 \(штрих код для примера\)  
Кросс-бренд: Bosch  
Тип кросса: Штрих-код другого производителя
{% endhint %}



## Алгоритм определения типа кросса для режима полного кроссирования

Получаем таблицу всех вариантов \(очищенную от уже существующих кроссов\), которая выглядит как: артикул - бренд - кросс-артикул - кросс-бренд. Тип кросса пока не определен.

1. Проверяем, имела ли пара артикул + бренд тип кросса равным типу "Короткий номер", "Штрих-код", "Короткий номер другого производителя", "Штрих-код другого производителя", "Составная часть" \(номера 3, 14, 20, 103, 114\). Для таких типов кроссов в справочнике типов установлен флаг "Не разворачиваются". Если пара имела такой тип, то такая запись неверна и удаляем такие записи из таблицы.
2. Проверяем по паре кросс-артикул и кросс-бренд. Если бренд справа производитель авто = истина, тогда тип кросса = 8. Отрабатываем по правилам, устанавливаем необходимый тип для обратного кросса. В таблице остаются снова только записи без типов кроссов.
3. Проверяем по бренду слева и паре справа. Если бренд слева производитель авто равно истина, а кросс-артикул и кросс-бренд справа имели тип кросса 11, то устанавливаем тип кросса = 11.
4. Все оставшиеся кроссы-записи имеют тип кросса = 2, поскольку все остальные варианты типов кроссов мы уже исключили при первых 3 проходах.

